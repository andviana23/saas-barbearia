# Fluxos de Agendamento - Jornadas do Usu√°rio

## üìã Vis√£o Geral

Este documento detalha os **fluxos completos de agendamento** baseados nas melhores pr√°ticas dos l√≠deres de mercado (Trinks, OneBeleza) com otimiza√ß√µes espec√≠ficas para o contexto de barbearias premium.

## üéØ Princ√≠pios dos Fluxos

### **Inspira√ß√£o: Trinks + OneBeleza**
- **Trinks**: Foco em convers√£o e fideliza√ß√£o
- **OneBeleza**: UX intuitiva e notifica√ß√µes inteligentes
- **Diferencial**: **Sem SMS autom√°tico** (redu√ß√£o de custos)

### **Otimiza√ß√µes Implementadas**
- ‚úÖ Agendamento em **m√°ximo 3 cliques**
- ‚úÖ Valida√ß√£o de conflitos **em tempo real**
- ‚úÖ Confirma√ß√£o via **WhatsApp/Email** apenas
- ‚úÖ Interface **mobile-first**
- ‚úÖ **Reagendamento simplificado**

---

## üë§ Fluxo 1: Agendamento pelo Cliente

### **1.1 Acesso ao Sistema**

```mermaid
graph TD
    A[Cliente acessa agenda] --> B{Est√° logado?}
    B -->|Sim| C[Dashboard de agendamentos]
    B -->|N√£o| D[Login/Cadastro r√°pido]
    D --> E[Verifica√ß√£o WhatsApp/Email]
    E --> C
    C --> F[Visualizar agenda dispon√≠vel]
```

#### **Tela de Entrada**
- **Layout**: Calend√°rio em destaque com hor√°rios dispon√≠veis
- **CTA Principal**: "Agendar Hor√°rio" (bot√£o flutuante)
- **Informa√ß√µes**: Profissionais dispon√≠veis, servi√ßos, pre√ßos
- **Filtros**: Por profissional, servi√ßo, data

### **1.2 Sele√ß√£o de Servi√ßos**

```typescript
// Fluxo de sele√ß√£o
interface SelecaoServico {
  step: 'servicos' | 'profissional' | 'horario' | 'confirmacao';
  servicos: Servico[];
  profissional?: Profissional;
  horario?: TimeSlot;
  duracao_total: number;
  valor_total: number;
}
```

#### **Passo 1: Escolha de Servi√ßos**
- **Interface**: Cards com imagens, descri√ß√£o e pre√ßo
- **Sele√ß√£o M√∫ltipla**: Checkbox para combinar servi√ßos
- **C√°lculo Autom√°tico**: Dura√ß√£o e valor total em tempo real
- **Sugest√µes**: "Clientes tamb√©m escolheram..."

#### **Passo 2: Sele√ß√£o de Profissional**
- **Filtro Autom√°tico**: Apenas profissionais que fazem os servi√ßos
- **Informa√ß√µes**: Foto, nome, especialidades, avalia√ß√£o
- **Disponibilidade**: Indicador visual de hor√°rios livres
- **Op√ß√£o**: "Qualquer profissional dispon√≠vel"

#### **Passo 3: Escolha de Hor√°rio**
- **Calend√°rio Visual**: Slots dispon√≠veis destacados
- **Views**: Semana (desktop) / Dia (mobile)
- **Tempo Real**: Atualiza√ß√£o autom√°tica de disponibilidade
- **Sugest√µes**: "Hor√°rios mais pr√≥ximos dispon√≠veis"

### **1.3 Confirma√ß√£o e Finaliza√ß√£o**

```typescript
// Dados da confirma√ß√£o
interface ConfirmacaoAgendamento {
  resumo: {
    servicos: string[];
    profissional: string;
    data_hora: Date;
    duracao: number;
    valor: number;
  };
  cliente: {
    nome: string;
    telefone: string;
    email: string;
  };
  observacoes?: string;
  forma_pagamento: 'dinheiro' | 'cartao' | 'pix';
}
```

#### **Tela de Confirma√ß√£o**
- **Resumo Visual**: Card com todos os detalhes
- **Dados do Cliente**: Pr√©-preenchidos se logado
- **Observa√ß√µes**: Campo opcional para pedidos especiais
- **Forma de Pagamento**: Sele√ß√£o para organiza√ß√£o interna
- **Pol√≠ticas**: Cancelamento, reagendamento, atraso

#### **Confirma√ß√£o Final**
- **Valida√ß√£o**: Verifica√ß√£o final de disponibilidade
- **Cria√ß√£o**: Agendamento salvo no sistema
- **Notifica√ß√£o**: WhatsApp/Email de confirma√ß√£o
- **Redirecionamento**: Tela de sucesso com detalhes

---

## üë®‚Äçüíº Fluxo 2: Gest√£o pelo Profissional

### **2.1 Dashboard do Profissional**

```mermaid
graph TD
    A[Login Profissional] --> B[Dashboard Agenda]
    B --> C[Visualizar agendamentos do dia]
    B --> D[Bloquear hor√°rios]
    B --> E[Gerenciar disponibilidade]
    B --> F[Atualizar status dos atendimentos]
```

#### **Interface Principal**
- **View Padr√£o**: Agenda do dia atual
- **Navega√ß√£o**: Bot√µes para dia anterior/pr√≥ximo
- **Status Visual**: Cores diferentes por status de agendamento
- **A√ß√µes R√°pidas**: Confirmar, cancelar, reagendar

### **2.2 Gerenciamento de Hor√°rios**

#### **Bloqueio de Hor√°rios**
```typescript
interface BloqueioHorario {
  tipo: 'almoco' | 'reuniao' | 'folga' | 'manutencao';
  data_inicio: Date;
  data_fim: Date;
  recorrente?: {
    frequencia: 'diaria' | 'semanal' | 'mensal';
    dias_semana?: number[];
    data_limite?: Date;
  };
  motivo?: string;
}
```

- **Tipos de Bloqueio**: Almo√ßo, reuni√£o, folga, manuten√ß√£o
- **Recorr√™ncia**: Op√ß√£o para bloqueios repetitivos
- **Visualiza√ß√£o**: Bloqueios aparecem como eventos no calend√°rio
- **Edi√ß√£o**: Arrastar para redimensionar, clique para editar

#### **Configura√ß√£o de Disponibilidade**
- **Hor√°rio de Trabalho**: In√≠cio e fim por dia da semana
- **Intervalos**: Pausas autom√°ticas entre atendimentos
- **Servi√ßos**: Quais servi√ßos o profissional oferece
- **Dura√ß√£o Personalizada**: Tempo espec√≠fico por servi√ßo

### **2.3 Atendimento e Status**

#### **Durante o Atendimento**
- **Check-in**: Marcar in√≠cio do atendimento
- **Observa√ß√µes**: Adicionar notas sobre o servi√ßo
- **Produtos Utilizados**: Registrar consumo de produtos
- **Check-out**: Finalizar e marcar como conclu√≠do

#### **Gest√£o de Status**
```typescript
enum StatusAgendamento {
  PENDENTE = 'pendente',        // Aguardando confirma√ß√£o
  CONFIRMADO = 'confirmado',    // Cliente confirmou presen√ßa
  EM_ANDAMENTO = 'em_andamento', // Atendimento iniciado
  CONCLUIDO = 'concluido',      // Atendimento finalizado
  CANCELADO = 'cancelado',      // Cancelado por qualquer motivo
  NAO_COMPARECEU = 'nao_compareceu', // No-show
  REAGENDADO = 'reagendado'     // Transferido para outro hor√°rio
}
```

---

## üè¢ Fluxo 3: Administra√ß√£o e Gest√£o

### **3.1 Dashboard Administrativo**

```mermaid
graph TD
    A[Admin/Manager Login] --> B[Dashboard Geral]
    B --> C[Vis√£o Geral do Dia]
    B --> D[Relat√≥rios de Performance]
    B --> E[Configura√ß√µes do Sistema]
    B --> F[Gest√£o de Profissionais]
```

#### **Vis√£o Geral**
- **M√©tricas do Dia**: Agendamentos, receita, taxa de ocupa√ß√£o
- **Calend√°rio Consolidado**: Todos os profissionais em uma view
- **Alertas**: Conflitos, cancelamentos, no-shows
- **A√ß√µes R√°pidas**: Criar agendamento, bloquear hor√°rio

### **3.2 Gest√£o de Agendamentos**

#### **Cria√ß√£o Manual**
- **Busca de Cliente**: Por nome, telefone ou email
- **Sele√ß√£o R√°pida**: Servi√ßos e profissionais favoritos
- **Valida√ß√£o Autom√°tica**: Conflitos e disponibilidade
- **Observa√ß√µes**: Notas internas e do cliente

#### **Opera√ß√µes em Massa**
```typescript
interface AcaoMassa {
  agendamentos: string[];
  acao: 'cancelar' | 'reagendar' | 'confirmar' | 'notificar';
  parametros?: {
    nova_data?: Date;
    motivo?: string;
    template_notificacao?: string;
  };
}
```

- **Sele√ß√£o M√∫ltipla**: Checkbox nos agendamentos
- **A√ß√µes Dispon√≠veis**: Cancelar, reagendar, confirmar, notificar
- **Confirma√ß√£o**: Modal com resumo das a√ß√µes
- **Log de Atividades**: Registro de todas as altera√ß√µes

### **3.3 Relat√≥rios e Analytics**

#### **M√©tricas de Performance**
```typescript
interface MetricasAgenda {
  periodo: DateRange;
  dados: {
    total_agendamentos: number;
    taxa_ocupacao: number;
    receita_total: number;
    ticket_medio: number;
    taxa_cancelamento: number;
    taxa_no_show: number;
    horarios_pico: TimeSlot[];
    servicos_populares: ServicoMetrica[];
    profissionais_performance: ProfissionalMetrica[];
  };
}
```

#### **Relat√≥rios Dispon√≠veis**
- **Ocupa√ß√£o por Profissional**: Taxa de utiliza√ß√£o dos hor√°rios
- **Servi√ßos Mais Agendados**: Ranking de popularidade
- **Hor√°rios de Pico**: An√°lise de demanda por per√≠odo
- **Taxa de Convers√£o**: Agendamentos vs cancelamentos
- **Receita por Per√≠odo**: Faturamento detalhado

---

## üì± Fluxo 4: Experi√™ncia Mobile

### **4.1 Otimiza√ß√µes Mobile**

#### **Interface Adaptada**
- **View Padr√£o**: Agenda do dia (mais adequada para tela pequena)
- **Navega√ß√£o**: Swipe para mudar de dia
- **Eventos**: Cards expandidos com mais informa√ß√µes
- **FAB**: Bot√£o flutuante para novo agendamento

#### **Gestos de Toque**
```typescript
interface GestosMobile {
  swipe_horizontal: 'navegar_dias';
  swipe_vertical: 'scroll_horarios';
  tap: 'selecionar_evento';
  long_press: 'menu_contexto';
  pinch: 'zoom_calendario';
  pull_to_refresh: 'atualizar_dados';
}
```

### **4.2 Notifica√ß√µes Push**

#### **Tipos de Notifica√ß√£o**
```typescript
interface NotificacaoPush {
  tipo: 'confirmacao' | 'lembrete' | 'cancelamento' | 'reagendamento';
  agendamento_id: string;
  titulo: string;
  mensagem: string;
  acao?: {
    label: string;
    deep_link: string;
  };
  agendamento?: Date;
}
```

#### **Cronograma de Notifica√ß√µes**
- **Confirma√ß√£o**: Imediatamente ap√≥s agendamento
- **Lembrete 24h**: 1 dia antes do agendamento
- **Lembrete 2h**: 2 horas antes do agendamento
- **Cancelamento**: Imediatamente quando cancelado
- **Reagendamento**: Quando nova data √© definida

---

## üîÑ Fluxo 5: Reagendamento e Cancelamento

### **5.1 Reagendamento pelo Cliente**

```mermaid
graph TD
    A[Cliente solicita reagendamento] --> B[Verificar pol√≠tica de reagendamento]
    B -->|Permitido| C[Mostrar hor√°rios dispon√≠veis]
    B -->|N√£o permitido| D[Mostrar mensagem de pol√≠tica]
    C --> E[Cliente escolhe novo hor√°rio]
    E --> F[Validar disponibilidade]
    F -->|Dispon√≠vel| G[Confirmar reagendamento]
    F -->|Indispon√≠vel| C
    G --> H[Notificar profissional]
    H --> I[Atualizar agenda]
```

#### **Pol√≠ticas de Reagendamento**
```typescript
interface PoliticaReagendamento {
  antecedencia_minima: number; // horas
  limite_reagendamentos: number; // por agendamento
  taxa_reagendamento?: number; // valor em reais
  horario_limite?: string; // ex: "18:00"
  dias_permitidos?: number[]; // 0-6 (dom-sab)
}
```

### **5.2 Cancelamento**

#### **Fluxo de Cancelamento**
- **Acesso**: Link no email/WhatsApp ou √°rea do cliente
- **Confirma√ß√£o**: Modal com pol√≠tica de cancelamento
- **Motivo**: Sele√ß√£o opcional do motivo
- **Processamento**: Libera√ß√£o autom√°tica do hor√°rio
- **Notifica√ß√£o**: Confirma√ß√£o para cliente e profissional

#### **Pol√≠ticas de Cancelamento**
```typescript
interface PoliticaCancelamento {
  antecedencia_minima: number; // horas
  taxa_cancelamento?: {
    valor: number;
    antecedencia_limite: number; // horas
  };
  reembolso?: {
    percentual: number;
    prazo_dias: number;
  };
}
```

---

## üîî Fluxo 6: Notifica√ß√µes e Comunica√ß√£o

### **6.1 Sistema de Notifica√ß√µes**

#### **Canais de Comunica√ß√£o**
- ‚úÖ **WhatsApp**: Canal principal (API Business)
- ‚úÖ **Email**: Backup e confirma√ß√µes formais
- ‚ùå **SMS**: Removido para reduzir custos
- ‚úÖ **Push**: Para app mobile

#### **Templates de Mensagem**

```typescript
// WhatsApp Templates
const whatsappTemplates = {
  confirmacao: `
üéâ *Agendamento Confirmado!*

üìÖ Data: {{data}}
üïê Hor√°rio: {{horario}}
üíá‚Äç‚ôÇÔ∏è Profissional: {{profissional}}
‚úÇÔ∏è Servi√ßos: {{servicos}}
üí∞ Valor: {{valor}}

üìç Endere√ßo: {{endereco}}

Para reagendar ou cancelar: {{link}}
  `,
  
  lembrete_24h: `
‚è∞ *Lembrete de Agendamento*

Ol√° {{cliente}}! Seu hor√°rio √© amanh√£:

üìÖ {{data}} √†s {{horario}}
üíá‚Äç‚ôÇÔ∏è Com {{profissional}}
‚úÇÔ∏è {{servicos}}

Confirme sua presen√ßa: {{link_confirmacao}}
Precisa reagendar? {{link_reagendamento}}
  `,
  
  lembrete_2h: `
üîî *Seu hor√°rio √© em 2 horas!*

üìÖ Hoje √†s {{horario}}
üíá‚Äç‚ôÇÔ∏è Com {{profissional}}
üìç {{endereco}}

Nos vemos em breve! üòä
  `,
};
```

### **6.2 Automa√ß√µes Inteligentes**

#### **Triggers Autom√°ticos**
```typescript
interface AutomacaoNotificacao {
  evento: 'agendamento_criado' | 'agendamento_alterado' | 'lembrete_24h' | 'lembrete_2h';
  condicoes?: {
    status?: StatusAgendamento[];
    antecedencia_minima?: number;
    primeira_vez?: boolean;
  };
  acoes: {
    whatsapp?: boolean;
    email?: boolean;
    push?: boolean;
    delay?: number; // minutos
  };
}
```

#### **Personaliza√ß√µes**
- **Hor√°rio de Envio**: Respeitar hor√°rio comercial
- **Frequ√™ncia**: Evitar spam com cooldown
- **Prefer√™ncias**: Cliente pode escolher canais
- **Segmenta√ß√£o**: Mensagens diferentes por tipo de cliente

---

## üìä Fluxo 7: M√©tricas e Otimiza√ß√£o

### **7.1 Tracking de Convers√£o**

#### **Funil de Agendamento**
```typescript
interface FunilAgendamento {
  etapas: {
    visualizacao_agenda: number;
    selecao_servico: number;
    selecao_profissional: number;
    selecao_horario: number;
    preenchimento_dados: number;
    confirmacao_final: number;
  };
  taxa_conversao: number;
  pontos_abandono: string[];
}
```

#### **M√©tricas de UX**
- **Tempo por Etapa**: Dura√ß√£o m√©dia em cada passo
- **Taxa de Abandono**: Onde os usu√°rios desistem
- **Dispositivo**: Performance mobile vs desktop
- **Hor√°rio**: Quando mais agendamentos s√£o feitos

### **7.2 Otimiza√ß√£o Cont√≠nua**

#### **A/B Tests**
- **Layout**: Diferentes disposi√ß√µes de elementos
- **CTAs**: Textos e cores de bot√µes
- **Fluxo**: Ordem das etapas de agendamento
- **Notifica√ß√µes**: Templates e hor√°rios de envio

#### **Feedback Loop**
```typescript
interface FeedbackSistema {
  origem: 'cliente' | 'profissional' | 'admin';
  tipo: 'bug' | 'sugestao' | 'elogio' | 'reclamacao';
  categoria: 'interface' | 'performance' | 'funcionalidade';
  descricao: string;
  prioridade: 'baixa' | 'media' | 'alta' | 'critica';
  status: 'aberto' | 'em_analise' | 'resolvido' | 'rejeitado';
}
```

---

## üéØ Resumo dos Diferenciais

### **Vs. Trinks**
- ‚úÖ **Sem SMS**: Redu√ß√£o de custos operacionais
- ‚úÖ **UX Simplificada**: Menos cliques para agendar
- ‚úÖ **Mobile-First**: Interface otimizada para celular

### **Vs. OneBeleza**
- ‚úÖ **Especializa√ß√£o**: Foco espec√≠fico em barbearias
- ‚úÖ **Integra√ß√£o**: Sistema unificado com gest√£o
- ‚úÖ **Performance**: Carregamento mais r√°pido

### **Inova√ß√µes Pr√≥prias**
- üöÄ **Reagendamento Inteligente**: Sugest√µes autom√°ticas
- üöÄ **Valida√ß√£o em Tempo Real**: Zero conflitos
- üöÄ **Analytics Avan√ßado**: Insights de neg√≥cio
- üöÄ **Tema Dark Premium**: Identidade visual √∫nica

---

**Pr√≥ximo**: [Especifica√ß√£o de Componentes](./COMPONENTES.md)